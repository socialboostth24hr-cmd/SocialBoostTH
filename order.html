<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ | SocialBoostTH</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --pink:#ec4899;
  --purple:#8b5cf6;
  --blue:#38bdf8;
  --gray:#64748b;
  --green:#22c55e;
  --yellow:#f59e0b;
  --red:#ef4444;
}
*{box-sizing:border-box}

body{
  margin:0;
  font-family:system-ui,-apple-system;
  background:
    radial-gradient(900px 360px at top,#fde7f3,transparent),
    linear-gradient(180deg,#eef6ff,#ffffff);
  min-height:100vh;
}

/* ===== Header ===== */
.header{
  padding:14px 18px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#fff;
  position:sticky;
  top:0;
  z-index:50;
}
.logo{height:34px}
.back-btn{
  border:none;
  padding:6px 14px;
  border-radius:999px;
  background:#fff;
  cursor:pointer;
  box-shadow:0 6px 18px rgba(0,0,0,.1);
}

/* ===== Content ===== */
.container{
  max-width:720px;
  margin:0 auto;
  padding:14px 18px 40px;
}

.title{
  font-size:26px;
  font-weight:900;
  margin:10px 0 6px;
  background:linear-gradient(90deg,var(--blue),var(--purple),var(--pink));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

.subtitle{
  font-size:14px;
  color:#94a3b8;
  margin-bottom:18px;
}

/* ===== Order Card ===== */
.order{
  background:#fff;
  border-radius:22px;
  padding:18px 20px;
  margin-bottom:14px;
  box-shadow:
    0 16px 40px rgba(139,92,246,.15),
    0 6px 14px rgba(56,189,248,.12);
}

.order-top{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.order-id{
  font-size:13px;
  color:#64748b;
}

.status{
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:800;
  color:#fff;
  white-space:nowrap;
}
.status.pending{background:var(--yellow);}
.status.processing{background:var(--blue);}
.status.success{background:var(--green);}
.status.cancel{background:var(--red);}

.service{
  margin-top:8px;
  font-size:15px;
  font-weight:800;
}

.detail{
  margin-top:6px;
  font-size:14px;
  color:#64748b;
}

.total{
  margin-top:10px;
  font-size:16px;
  font-weight:900;
}

.link{
  margin-top:6px;
  font-size:13px;
  color:#2563eb;
  word-break:break-all;
}

/* empty */
.empty{
  text-align:center;
  margin-top:40px;
  color:#94a3b8;
}
</style>
</head>

<body>

<header class="header">
  <button class="back-btn" onclick="location.href='services.html'">
    ‚Üê ‡∏Å‡∏•‡∏±‡∏ö
  </button>
  <img src="https://raw.githubusercontent.com/socialboostth24hr-cmd/SocialBoostTH/main/logo.png" class="logo">
</header>

<div class="container">
  <div class="title">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</div>
  <div class="subtitle">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>

  <div id="orders"></div>
</div>

<script>
const API =
"https://script.google.com/macros/s/AKfycbwpc_dUSc6lmVu-z18mqq72QDzljOAcqsMHJrYNHoJMIK-pP8wVS6BpS9Lvh8ON4iQDCA/exec";

const userId = localStorage.getItem('user_id');

/* üîí Guard login */
if(!userId){
  location.href='login.html';
}

/* status map */
const STATUS_TEXT = {
  pending: '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
  processing: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
  success: '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå',
  cancel: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
};

/* Load orders */
fetch(API + '?action=orders&user_id=' + userId)
.then(r=>r.json())
.then(list=>{
  const box = document.getElementById('orders');
  box.innerHTML='';

  if(!Array.isArray(list) || list.length===0){
    box.innerHTML = `
      <div class="empty">
        ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠<br>
        ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
      </div>`;
    return;
  }

  // ‡πÅ‡∏™‡∏î‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô
  list.reverse().forEach(o=>{
    box.innerHTML += `
      <div class="order">
        <div class="order-top">
          <div class="order-id">Order #${o.order_id}</div>
          <div class="status ${o.status}">
            ${STATUS_TEXT[o.status] || o.status}
          </div>
        </div>

        <div class="service">
          ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£: ${o.service_id}
        </div>

        <div class="detail">
          ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${o.qty}
        </div>

        <div class="total">
          ‡∏£‡∏ß‡∏° ${Number(o.final_total).toFixed(2)} ‡∏ö‡∏≤‡∏ó
        </div>

        <div class="link">
          ${o.link || ''}
        </div>
      </div>
    `;
  });
})
.catch(()=>{
  document.getElementById('orders').innerHTML =
    '<p style="color:red">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</p>';
});
</script>

</body>
</html>
