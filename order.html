<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ | SocialBoostTH</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root{
  --black:#0b0f1a;
  --blue:#38bdf8;
  --purple:#8b5cf6;
  --pink:#ec4899;
  --danger:#fb7185;
  --muted:#94a3b8;
  --line:#1f2a44;
  --green:#22c55e;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system;
  background:
    radial-gradient(900px 420px at top,#1e293b,transparent),
    linear-gradient(180deg,var(--black),#060913);
  color:#f1f5f9;
}
.header{
  padding:12px 16px;
  display:grid;
  grid-template-columns:auto 1fr auto;
  align-items:center;
  gap:12px;
  background:rgba(2,6,23,.75);
  backdrop-filter:blur(10px);
  position:sticky;top:0;
}
.back{border:none;padding:6px 14px;border-radius:999px;background:rgba(255,255,255,.08);color:#e5e7eb;font-weight:900}
.center{
  text-align:center;font-weight:900;
  background:linear-gradient(90deg,var(--blue),var(--purple),var(--pink));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.wallet{
  font-size:13px;padding:6px 14px;border-radius:999px;font-weight:900;
  background:linear-gradient(#020617,#020617) padding-box,
             linear-gradient(135deg,var(--blue),var(--purple)) border-box;
  border:1px solid transparent;
}
.container{max-width:720px;margin:auto;padding:20px 18px 200px}
.card{
  background:linear-gradient(180deg,#111827,#0b1020);
  border-radius:26px;padding:22px;margin-bottom:18px;
}
.title{font-size:22px;font-weight:900}
.desc{font-size:13px;color:var(--muted);margin-top:6px}
.badge{
  display:inline-block;margin-top:8px;
  font-size:12px;font-weight:900;
  padding:4px 10px;border-radius:999px;
  background:#020617;border:1px solid #1f2a44;
}
.section{margin-top:14px;font-size:14px}
.section div{margin-bottom:6px}
label{display:block;font-weight:900;margin:16px 0 6px}
input,textarea{
  width:100%;padding:14px;border-radius:16px;
  border:none;background:#020617;color:#fff;font-size:15px
}
textarea{min-height:120px}
.hint{font-size:13px;color:var(--muted);margin-top:6px}
.total{font-size:22px;font-weight:900;margin-top:20px}
.error{margin-top:12px;font-weight:900;color:var(--danger)}
.terms{
  margin-top:16px;
  background:#020617;
  border:1px solid #1f2a44;
  border-radius:16px;
  padding:14px;
  font-size:13px;
  color:#cbd5f5;
}
.terms input{width:auto;margin-right:6px}
.buy{
  position:fixed;bottom:16px;left:50%;
  transform:translateX(-50%);
  width:calc(100% - 32px);
  max-width:480px;
  padding:16px;border-radius:999px;border:none;
  background:linear-gradient(135deg,var(--blue),var(--purple),var(--pink));
  color:#fff;font-size:18px;font-weight:900;
}
.buy:disabled{opacity:.45}
</style>
</head>

<body>

<header class="header">
  <button class="back" onclick="history.back()">‚Üê</button>
  <div class="center">SocialBoostTH</div>
  <div class="wallet">‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï: <span id="credit">0.00</span> ‡∏ö‡∏≤‡∏ó</div>
</header>

<div class="container">

  <div class="card">
    <div class="title" id="serviceName">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‚Ä¶</div>
    <div class="desc" id="serviceDesc"></div>
    <div class="badge" id="serviceBadge"></div>
    <div class="section" id="serviceDetails"></div>
  </div>

  <div class="card">
    <label>‡∏•‡∏¥‡∏á‡∏Å‡πå TikTok</label>
    <textarea id="link"></textarea>

    <div id="commentBox">
      <label>‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå (1 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î = 1 ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå)</label>
      <textarea id="comments"></textarea>
      <div class="hint">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå: <b id="commentCount">0</b></div>
    </div>

    <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
    <input type="number" id="qty">

    <div class="total">‡∏£‡∏ß‡∏°: <span id="total">0.00</span> ‡∏ö‡∏≤‡∏ó</div>
    <div class="error" id="error"></div>

    <div class="terms">
      <label>
        <input type="checkbox" id="accept">
        ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
      </label>
      <div style="margin-top:8px">
        <b>SocialBoostth24hr</b><br>
        ‡∏Ç‡∏≠‡πÅ‡∏à‡πâ‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏∏‡∏Å‡∏ó‡πà‡∏≤‡∏ô‡∏ß‡πà‡∏≤ TikTok ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏¢‡∏≠‡∏î‡∏•‡∏î‡∏•‡∏á‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥
        ‡∏ó‡∏≤‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡πÄ‡∏Ñ‡∏•‡∏°‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ<br>
        1) ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î<br>
        2) ‡∏™‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≥ ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î<br>
        3) ‡πÄ‡∏Ñ‡∏•‡∏°‡∏¢‡∏≠‡∏î‡∏•‡∏î ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ LINE ‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
      </div>
    </div>

  </div>
</div>

<button class="buy" id="buyBtn" disabled>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>

<script>
/* ==== JS ‡πÄ‡∏î‡∏¥‡∏° + ‡πÄ‡∏û‡∏¥‡πà‡∏° logic ‡∏Ñ‡∏£‡∏≠‡∏ö ==== */
const API="https://script.google.com/macros/s/AKfycbwbGEMA1-x1c63RENR3wMQE6QQtYhCKQ50i8R-mW3WRJZxMc8adY0RmpZFI6-VaF5aX0w/exec";
const API_KEY="SBTH-SECURE-2026";

const userId=localStorage.getItem('user_id');
const serviceId=localStorage.getItem('service_id');
if(!userId||!serviceId) location.href='services.html';

const creditEl=document.getElementById('credit');
const serviceNameEl=document.getElementById('serviceName');
const serviceDescEl=document.getElementById('serviceDesc');
const serviceDetailsEl=document.getElementById('serviceDetails');
const badgeEl=document.getElementById('serviceBadge');

const linkEl=document.getElementById('link');
const commentsEl=document.getElementById('comments');
const commentCountEl=document.getElementById('commentCount');
const commentBox=document.getElementById('commentBox');

const qtyEl=document.getElementById('qty');
const totalEl=document.getElementById('total');
const errorEl=document.getElementById('error');
const buyBtn=document.getElementById('buyBtn');
const accept=document.getElementById('accept');

let service=null, details=[], discounts=[], credit=0;

/* ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï */
fetch(`${API}?action=getWallet&api_key=${API_KEY}&user_id=${userId}`)
.then(r=>r.json()).then(res=>{
  const logs=res.logs||[];
  if(logs.length) credit=Number(logs.at(-1).credit_after||0);
  creditEl.textContent=credit.toFixed(2);
});

/* ‡πÇ‡∏´‡∏•‡∏î‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ + detail */
fetch(`${API}?action=getServices&api_key=${API_KEY}`)
.then(r=>r.json()).then(res=>{
  service=res.services.find(s=>s.service_id===serviceId);
  if(!service) return;

  serviceNameEl.textContent=service.display_name;
  serviceDescEl.textContent=service.short_desc||'';

  badgeEl.textContent=service.detail_group==='TH'?'üáπüá≠ ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢':'üåê ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏≤‡∏ï‡∏¥';

  fetch(`${API}?action=getServiceDetails&api_key=${API_KEY}&service_id=${serviceId}`)
  .then(r=>r.json()).then(d=>{
    details=d.details||[];
    serviceDetailsEl.innerHTML=details.map(x=>`<div>${x.content}</div>`).join('');
  });

  if(service.detail_group!=='comment'){
    commentBox.style.display='none';
    qtyEl.readOnly=false;
  }else{
    qtyEl.readOnly=true;
  }
});

/* ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå */
commentsEl.addEventListener('input',()=>{
  const lines=commentsEl.value.split('\n').map(l=>l.trim()).filter(Boolean);
  qtyEl.value=lines.length;
  commentCountEl.textContent=lines.length;
  calc();
});
qtyEl.addEventListener('input',calc);
linkEl.addEventListener('input',calc);
accept.addEventListener('change',calc);

/* ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì */
function calc(){
  errorEl.textContent='';
  let qty=Number(qtyEl.value||0);
  if(!qty){ totalEl.textContent='0.00'; buyBtn.disabled=true; return; }
  if(qty<service.min_qty){ errorEl.textContent=`‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ${service.min_qty}`; buyBtn.disabled=true; return; }

  let total=qty*service.price_per_100/100;
  total=+total.toFixed(2);
  totalEl.textContent=total.toFixed(2);

  if(total>credit){ errorEl.textContent='‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠'; buyBtn.disabled=true; return; }
  buyBtn.disabled=!linkEl.value.trim()||!accept.checked;
}

/* ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ */
buyBtn.onclick=()=>{
  buyBtn.disabled=true;
  fetch(`${API}?`+new URLSearchParams({
    action:'createOrder',
    api_key:API_KEY,
    user_id:userId,
    service_id:serviceId,
    qty:qtyEl.value,
    link:linkEl.value+"\n"+(commentsEl.value||'')
  }))
  .then(r=>r.json())
  .then(res=>res.success?location.href='orders.html':errorEl.textContent=res.error||'‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î');
};
</script>

</body>
</html>