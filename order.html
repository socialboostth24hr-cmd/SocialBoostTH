<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ | SocialBoostTH</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --black:#0b0f1a;
  --blue:#38bdf8;
  --purple:#8b5cf6;
  --pink:#ec4899;
  --danger:#fb7185;
  --muted:#94a3b8;
  --line:#1f2a44;
  --green:#22c55e;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system;
  background:
    radial-gradient(900px 420px at top,#1e293b,transparent),
    linear-gradient(180deg,var(--black),#060913);
  color:#f1f5f9;
}
.header{
  padding:12px 16px;
  display:grid;
  grid-template-columns:auto 1fr auto;
  align-items:center;
  background:rgba(2,6,23,.75);
  backdrop-filter:blur(10px);
  position:sticky;top:0;
}
.back{
  border:none;padding:6px 14px;border-radius:999px;
  background:rgba(255,255,255,.08);
  color:#e5e7eb;font-weight:900;
}
.center{
  font-weight:900;
  background:linear-gradient(90deg,var(--blue),var(--purple),var(--pink));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.wallet{
  font-size:13px;padding:6px 14px;border-radius:999px;font-weight:900;
  background:
    linear-gradient(#020617,#020617) padding-box,
    linear-gradient(135deg,var(--blue),var(--purple)) border-box;
  border:1px solid transparent;
}
.container{max-width:720px;margin:auto;padding:20px 18px 160px}
.card{
  background:linear-gradient(180deg,#111827,#0b1020);
  border-radius:26px;padding:22px;margin-bottom:18px;
}
.title{font-size:22px;font-weight:900}
.desc{font-size:13px;color:var(--muted);margin-top:6px}
label{display:block;font-weight:900;margin:16px 0 6px}
input,textarea{
  width:100%;padding:14px;border-radius:16px;
  border:none;background:#020617;color:#fff;font-size:15px
}
textarea{min-height:120px}
.hint{font-size:13px;color:var(--muted);margin-top:6px}
.total{font-size:22px;font-weight:900;margin-top:14px}
.sub{font-size:13px;color:var(--green)}
.discount-tip{font-size:13px;color:#fde047;margin-top:6px}
.error{margin-top:12px;font-weight:900;color:var(--danger)}
.buy{
  position:fixed;bottom:16px;left:50%;
  transform:translateX(-50%);
  width:calc(100% - 32px);
  max-width:480px;
  padding:16px;border-radius:999px;border:none;
  background:linear-gradient(135deg,var(--blue),var(--purple),var(--pink));
  color:#fff;font-size:18px;font-weight:900;
}
.buy:disabled{opacity:.5}

/* popup */
.modal{
  position:fixed;inset:0;background:rgba(0,0,0,.6);
  display:none;align-items:center;justify-content:center;
}
.modal .box{
  background:#020617;border-radius:22px;padding:22px;
  max-width:420px;width:90%;
}
.modal h3{margin:0 0 12px}
.modal button{margin-top:16px;width:100%}
.close{
  position:absolute;top:12px;right:16px;font-size:22px;
  cursor:pointer;color:#94a3b8;
}
</style>
</head>

<body>

<header class="header">
  <button class="back" onclick="history.back()">‚Üê</button>
  <div class="center">SocialBoostTH</div>
  <div class="wallet">‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï: <span id="credit">0.00</span> ‡∏ö‡∏≤‡∏ó</div>
</header>

<div class="container">
  <div class="card">
    <div class="title" id="serviceName">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‚Ä¶</div>
    <div class="desc" id="serviceDesc"></div>
    <div class="hint" id="serviceInfo"></div>
  </div>

  <div class="card">
    <label>‡∏•‡∏¥‡∏á‡∏Å‡πå</label>
    <textarea id="link"></textarea>

    <div id="commentBox" style="display:none">
      <label>‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ó‡πå (1 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î = 1 ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ó‡πå)</label>
      <textarea id="comments"></textarea>
      <div class="hint">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ó‡πå: <b id="commentCount">0</b></div>
    </div>

    <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
    <input type="number" id="qty">

    <div class="hint" id="minHint"></div>

    <div class="total">‡∏£‡∏ß‡∏°: <span id="total">0.00</span> ‡∏ö‡∏≤‡∏ó</div>
    <div class="sub">‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏´‡∏•‡∏±‡∏á‡∏ã‡∏∑‡πâ‡∏≠: <span id="after">0.00</span> ‡∏ö‡∏≤‡∏ó</div>
    <div class="discount-tip" id="discountTip"></div>
    <div class="error" id="error"></div>
  </div>
</div>

<button class="buy" id="buyBtn">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>

<!-- popup -->
<div class="modal" id="modal">
  <div class="box">
    <div class="close" onclick="closeModal()">√ó</div>
    <h3>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ SocialBoostTH24HR</h3>
    <p>
    ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å TikTok ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏¢‡∏≠‡∏î‡∏•‡∏î‡∏•‡∏á‡πÅ‡∏ö‡∏ö‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥<br><br>
    ‡∏ó‡∏≤‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ<br>
    1) ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô<br>
    2) ‡∏´‡∏≤‡∏Å‡∏™‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≥ ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà<br>
    3) ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏≤‡∏á LINE ‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
    </p>
    <label><input type="checkbox" id="agree"> ‡∏â‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</label>
    <button class="buy" id="confirmBuy" disabled>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
  </div>
</div>

<script>
const API="https://script.google.com/macros/s/AKfycbwbGEMA1-x1c63RENR3wMQE6QQtYhCKQ50i8R-mW3WRJZxMc8adY0RmpZFI6-VaF5aX0w/exec";
const API_KEY="SBTH-SECURE-2026";
const userId=localStorage.getItem('user_id');
const serviceId=localStorage.getItem('service_id');
if(!userId||!serviceId) location.href='services.html';

let service=null, discounts=[], credit=0;

const creditEl=creditSpan=document.getElementById('credit');
credit=Number(localStorage.getItem('credit')||0);
creditEl.textContent=credit.toFixed(2);

fetch(`${API}?action=getUser&api_key=${API_KEY}&user_id=${userId}`)
.then(r=>r.json()).then(res=>{
  if(res.success){
    credit=res.credit;
    creditEl.textContent=credit.toFixed(2);
    localStorage.setItem('credit',credit);
  }
});

const qtyEl=document.getElementById('qty');
const totalEl=document.getElementById('total');
const afterEl=document.getElementById('after');
const errorEl=document.getElementById('error');
const discountTip=document.getElementById('discountTip');

fetch(`${API}?action=getServices&api_key=${API_KEY}`)
.then(r=>r.json()).then(res=>{
  service=res.services.find(s=>s.service_id===serviceId);
  document.getElementById('serviceName').textContent=service.display_name;
  document.getElementById('serviceDesc').textContent=service.short_desc||'';
  document.getElementById('serviceInfo').textContent=
    `‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ${service.min_qty} ‚Ä¢ ${service.price_per_100} ‡∏ö‡∏≤‡∏ó / 100`;

  qtyEl.value=service.min_qty;
  document.getElementById('minHint').textContent=`‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ${service.min_qty}`;
});

fetch(`${API}?action=getDiscounts&api_key=${API_KEY}&service_id=${serviceId}`)
.then(r=>r.json()).then(d=>discounts=d.discounts||[]);

qtyEl.addEventListener('input',calc);

function calc(){
  errorEl.textContent='';
  const qty=Number(qtyEl.value);
  if(qty<service.min_qty){
    errorEl.textContent=`‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ${service.min_qty}`;
    return;
  }
  let base=qty*service.price_per_100/100;
  let total=base;
  let applied=null;

  discounts.forEach(d=>{
    if(qty>=d.min_qty) applied=d;
  });
  if(applied){
    if(applied.price) total=qty*applied.price;
    if(applied.discount_percent)
      total=base*(100-applied.discount_percent)/100;
  }

  total=total.toFixed(2);
  totalEl.textContent=total;
  afterEl.textContent=(credit-total).toFixed(2);

  const next=discounts.find(d=>d.min_qty>qty);
  if(next){
    const save= (qty*service.price_per_100/100) -
      (qty*(next.price||service.price_per_100*(100-next.discount_percent)/100)/100);
    discountTip.textContent=`‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å ${next.min_qty-qty} ‡∏à‡∏∞‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î ~${save.toFixed(2)} ‡∏ö‡∏≤‡∏ó`;
  }else{
    discountTip.textContent='‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß üéâ';
  }
}

document.getElementById('buyBtn').onclick=()=>document.getElementById('modal').style.display='flex';
document.getElementById('agree').onchange=e=>{
  document.getElementById('confirmBuy').disabled=!e.target.checked;
};
document.getElementById('confirmBuy').onclick=()=>alert('‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢');

function closeModal(){document.getElementById('modal').style.display='none';}
</script>
</body>
</html>