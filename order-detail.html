<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ | SocialBoostTH</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --black:#0b0f1a;
  --blue:#38bdf8;
  --purple:#8b5cf6;
  --pink:#ec4899;
  --muted:#94a3b8;
  --line:#1f2a44;
  --success:#22c55e;
  --warn:#f59e0b;
  --danger:#ef4444;
}
*{box-sizing:border-box}

body{
  margin:0;
  font-family:system-ui,-apple-system;
  background:
    radial-gradient(900px 420px at top,#1e293b,transparent),
    linear-gradient(180deg,var(--black),#060913);
  color:#f1f5f9;
}

/* HEADER */
.header{
  padding:12px 16px;
  display:grid;
  grid-template-columns:auto 1fr auto;
  align-items:center;
  gap:12px;
  background:rgba(2,6,23,.8);
  backdrop-filter:blur(10px);
  position:sticky;
  top:0;
  z-index:50;
}
.back{
  border:none;
  padding:6px 14px;
  border-radius:999px;
  background:rgba(255,255,255,.08);
  color:#fff;
  font-weight:900;
  cursor:pointer;
}
.center{
  text-align:center;
  font-weight:900;
  background:linear-gradient(90deg,var(--blue),var(--purple),var(--pink));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

/* CONTAINER */
.container{
  max-width:720px;
  margin:auto;
  padding:18px 18px 140px;
}

.card{
  background:linear-gradient(180deg,#111827,#0b1020);
  border-radius:26px;
  padding:22px;
  margin-bottom:18px;
  box-shadow:
    0 25px 70px rgba(0,0,0,.7),
    0 0 0 1px rgba(139,92,246,.25);
}

.row{
  display:flex;
  justify-content:space-between;
  margin-top:10px;
  font-size:14px;
}
.row:first-child{margin-top:0}
.row b{font-weight:900}

.status{
  display:inline-block;
  margin-top:14px;
  padding:6px 14px;
  border-radius:999px;
  font-size:13px;
  font-weight:900;
}
.pending{background:#fef3c7;color:#92400e}
.processing{background:#e0f2fe;color:#075985}
.success{background:#dcfce7;color:#166534}
.cancel{background:#fee2e2;color:#991b1b}

.link{
  word-break:break-all;
  background:#020617;
  padding:14px;
  border-radius:16px;
  margin-top:10px;
  font-size:14px;
}

/* VALUE */
.value-box{
  border:1px solid var(--line);
  background:linear-gradient(180deg,#0b1224,#070b18);
}
.badge{
  display:inline-block;
  padding:4px 12px;
  border-radius:999px;
  font-size:11px;
  font-weight:900;
  background:linear-gradient(135deg,var(--blue),var(--purple),var(--pink));
  margin-bottom:10px;
}
.value-grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:12px;
  margin-top:14px;
}
.value-item{
  background:#020617;
  border-radius:16px;
  padding:12px;
  text-align:center;
}
.value-item b{font-size:16px}
.value-item span{font-size:12px;color:var(--muted)}

.buy-again{
  position:fixed;
  bottom:16px;
  left:50%;
  transform:translateX(-50%);
  width:calc(100% - 32px);
  max-width:480px;
  padding:16px;
  border-radius:999px;
  background:linear-gradient(135deg,var(--blue),var(--purple),var(--pink));
  color:#fff;
  font-weight:900;
  font-size:16px;
  text-align:center;
  text-decoration:none;
  box-shadow:0 18px 45px rgba(139,92,246,.6);
}
</style>
</head>

<body>

<header class="header">
  <button class="back" onclick="goBack()">‚Üê</button>
  <div class="center">SocialBoostTH</div>
  <div></div>
</header>

<div class="container">
  <div id="updateText" style="font-size:12px;color:#94a3b8;margin-bottom:10px">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‚Ä¶</div>

  <div class="card">
    <div class="row"><b>‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</b><span id="oid">-</span></div>
    <div class="row"><b>‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</b><span id="service">-</span></div>
    <div class="row"><b>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</b><span id="qty">-</span></div>
    <div class="row"><b>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</b><span id="total">-</span></div>
    <div class="row"><b>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</b><span id="date">-</span></div>
    <div class="status" id="status"></div>
  </div>

  <div class="card value-box hide" id="valueBox">
    <div class="badge">üî• ‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å</div>
    <div id="valueText"></div>
    <div class="value-grid" id="valueGrid"></div>
  </div>

  <div class="card">
    <b>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á</b>
    <div class="link" id="link">-</div>
  </div>
</div>

<a class="buy-again" href="services.html">üîÅ ‡∏ã‡∏∑‡πâ‡∏≠‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</a>

<script>
const API="https://script.google.com/macros/s/AKfycbxnG0FDeXxrWOFIhPCtREMcUKq5-uBCqi_BagqlD6OPWDXBnQn1Dt-8BKMaOv4ZstnQSg/exec";
const API_KEY="SBTH-SECURE-2026";

const orderId=localStorage.getItem('order_id');
const userId=localStorage.getItem('user_id');
if(!orderId||!userId) location.href='orders.html';

/* DOM */
const oidEl=oid;
const serviceEl=service;
const qtyEl=qty;
const totalEl=total;
const dateEl=date;
const linkEl=link;
const statusEl=status;
const valueBox=valueBox;
const valueText=valueText;
const valueGrid=valueGrid;
const updateText=updateText;

let servicesCache={};

function goBack(){history.length>1?history.back():location.href='orders.html'}

function statusText(s){
  if(s==='pending')return'‚è≥ ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£';
  if(s==='processing')return'üöÄ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£';
  if(s==='success')return'‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
  if(s==='cancel')return'‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å';
  return'-';
}

async function loadServices(){
  if(Object.keys(servicesCache).length) return;
  const r=await fetch(`${API}?action=services&api_key=${API_KEY}`);
  const list=await r.json();
  if(Array.isArray(list)){
    list.forEach(s=>servicesCache[s.service_id]=s.display_name);
  }
}

function safeDate(d){
  const t=Date.parse(d);
  return isNaN(t)?'-':new Date(t).toLocaleString();
}

async function loadDetail(){
  updateText.textContent='‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï...';
  await loadServices();

  const r=await fetch(`${API}?action=order_detail&api_key=${API_KEY}&order_id=${orderId}&user_id=${userId}`);
  const o=await r.json();
  if(!o||o.error) return;

  oidEl.textContent=o.order_id;
  serviceEl.textContent=servicesCache[o.service_id]||o.service_id;
  qtyEl.textContent=o.qty;
  totalEl.textContent=Number(o.final_total||0).toFixed(2)+' ‡∏ö‡∏≤‡∏ó';
  dateEl.textContent=safeDate(o.datetime);
  linkEl.textContent=o.link||'-';
  statusEl.className='status '+o.status;
  statusEl.textContent=statusText(o.status);

  if(o.qty && o.qty<1000){
    valueBox.classList.remove('hide');
    const next=o.qty*2;
    valueText.textContent=`‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏ß‡πà‡∏≤`;
    valueGrid.innerHTML=`
      <div class="value-item"><b>${o.qty}</b><span>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</span></div>
      <div class="value-item"><b>${next}</b><span>‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</span></div>
      <div class="value-item"><b>${next*2}</b><span>‡∏Ñ‡∏∏‡πâ‡∏°‡∏™‡∏∏‡∏î</span></div>
    `;
  }

  updateText.textContent='‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: '+new Date().toLocaleTimeString();
}

loadDetail();
</script>

</body>
</html>