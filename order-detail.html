<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå | SocialBoostTH</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg:#020617;
  --card:#0b1220;
  --border:#1f2937;
  --muted:#94a3b8;
  --blue:#38bdf8;
  --yellow:#f59e0b;
  --green:#22c55e;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system;
  background:#020617;
  color:#e5e7eb;
}
.wrap{
  max-width:720px;
  margin:auto;
  padding:18px 16px 120px;
}
.header{
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:16px;
}
.back{
  border:none;
  background:#0b1220;
  color:#fff;
  padding:8px 14px;
  border-radius:999px;
  cursor:pointer;
}
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:18px;
  padding:18px;
  margin-bottom:16px;
}
.row{
  display:flex;
  justify-content:space-between;
  margin-bottom:10px;
  gap:12px;
}
.small{font-size:13px;color:var(--muted)}
.badge{
  padding:5px 14px;
  border-radius:999px;
  font-size:12px;
  font-weight:900;
}
.pending{background:rgba(245,158,11,.15);color:var(--yellow)}
.processing{background:rgba(56,189,248,.15);color:var(--blue)}
.success{background:rgba(34,197,94,.18);color:var(--green)}
.price-box{
  display:flex;
  gap:10px;
}
.price{
  flex:1;
  background:#020617;
  border-radius:12px;
  padding:10px;
  text-align:center;
  font-size:13px;
}
.price b{font-size:16px}
.link{
  color:var(--blue);
  word-break:break-all;
  cursor:pointer;
  font-size:14px;
}
.comment{
  white-space:pre-line;
  background:#020617;
  border-radius:12px;
  padding:12px;
  font-size:13px;
}
.empty{
  text-align:center;
  color:var(--muted);
  padding:40px 0;
}
</style>
</head>

<body>

<div class="wrap">
  <div class="header">
    <button class="back" onclick="history.back()">‚Üê</button>
    <h2 style="margin:0">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h2>
  </div>

  <div id="content" class="empty">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‚Ä¶</div>
</div>

<script>
/* ================= CONFIG ================= */
const API_BASE = "https://script.google.com/macros/s/AKfycbyB5X9n_8U8huJJKC3O3r2n-gv-59oifcnzi2D6AaLcs5ul4-jFFbrcmzKglG5LYFX6iA/exec";
const API_KEY  = "SBTH-SECURE-2026";

/* ================= AUTH ================= */
const user_id  = localStorage.getItem("user_id");
const order_id = localStorage.getItem("order_id");

if(!user_id || !order_id){
  location.href="orders.html";
}

/* ================= UTILS ================= */
function formatTH(d){
  return new Date(d).toLocaleString("th-TH",
    {dateStyle:"medium",timeStyle:"short"});
}
function badge(s){
  if(s==="processing") return `<span class="badge processing">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥</span>`;
  if(s==="success") return `<span class="badge success">‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</span>`;
  return `<span class="badge pending">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</span>`;
}

/* ================= LOAD ================= */
fetch(`${API_BASE}?action=getOrders&api_key=${API_KEY}&user_id=${user_id}`)
.then(r=>r.json())
.then(res=>{
  if(!res.success){
    document.getElementById("content").innerHTML="‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
    return;
  }

  const o = res.orders.find(x=>x[0]===order_id);
  if(!o){
    document.getElementById("content").innerHTML="‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå";
    return;
  }

  document.getElementById("content").innerHTML=`
    <div class="card">
      <div class="row">
        <b>‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</b>
        <b>#${o[0]}</b>
      </div>
      <div class="row">
        <span class="small">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</span>
        <span class="small">${formatTH(o[9])}</span>
      </div>
      <div class="row">
        <span class="small">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</span>
        ${badge(o[10])}
      </div>
    </div>

    <div class="card">
      <b>üí∞ ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</b>
      <div class="price-box" style="margin-top:10px">
        <div class="price">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥<br><b>${o[4]}</b></div>
        <div class="price">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î<br><b>${o[5]}%</b></div>
        <div class="price">‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á<br><b>${o[6]}</b></div>
      </div>
    </div>

    <div class="card">
      <b>üîó ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á</b>
      <div class="link" onclick="window.open('${o[7]}')" style="margin-top:6px">
        ${o[7]}
      </div>
    </div>

    ${o[8] ? `
    <div class="card">
      <b>üí¨ ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ó‡πå</b>
      <div class="comment" style="margin-top:8px">${o[8]}</div>
    </div>` : ""}
  `;
})
.catch(()=>{
  document.getElementById("content").innerHTML="‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î";
});
</script>

</body>
</html>