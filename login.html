function login(){
  const user = username.value.trim();
  const pass = password.value.trim();
  error.innerText = '';

  fetch(API,{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
      action:'login',
      username:user,
      password:pass
    })
  })
  .then(r=>r.json())
  .then(res=>{
    if(!res.success){
      error.innerText = res.message;
      return;
    }
    localStorage.setItem('user_id',res.user.user_id);
    localStorage.setItem('credit',res.user.credit);
    location.href='services.html';
  })
  .catch(()=>error.innerText='เชื่อมต่อระบบไม่ได้');
}
