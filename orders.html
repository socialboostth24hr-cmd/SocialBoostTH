<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Orders | SocialBoostTH</title>

<style>
:root{
  --bg:#0b0f1a;
  --card:#12182a;
  --line:#1f2a44;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --primary:#8b5cf6;
  --success:#22c55e;
  --pending:#facc15;
  --danger:#ef4444;
}
*{box-sizing:border-box;font-family:-apple-system,Segoe UI,Roboto}
body{margin:0;background:var(--bg);color:var(--text)}
header{padding:16px;border-bottom:1px solid var(--line);font-size:20px;font-weight:700}
.container{max-width:900px;margin:auto;padding:16px}

.order-card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:14px;
  padding:16px;
  margin-bottom:14px;
}

.order-top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}

.badge{
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:700;
}

.pending{background:#facc1520;color:var(--pending)}
.processing{background:#38bdf820;color:#38bdf8}
.completed{background:#22c55e20;color:var(--success)}
.cancelled{background:#ef444420;color:var(--danger)}

.row{font-size:14px;color:var(--muted);margin-top:4px}
.link{color:var(--primary);word-break:break-all}
.price{font-weight:700;margin-top:6px}
.empty{text-align:center;color:var(--muted);margin-top:60px}
</style>
</head>

<body>
<header>üì¶ ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</header>

<div class="container" id="ordersBox">
  <div class="empty">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚Ä¶</div>
</div>

<script>
/* ================= CONFIG ================= */
const API_BASE = "https://script.google.com/macros/s/AKfycbxAK7GDFGG-W_cKJeZ6YVLG2CeJKRcnamrYCyeUW2M68kjjMjvRCh2jqUjYEtOWFGpmSw/exec";
const API_KEY  = "SBTH-SECURE-2026";

/* ====== ‡∏î‡∏∂‡∏á user_id (‡∏™‡∏°‡∏°‡∏ï‡∏¥ login ‡πÅ‡∏•‡πâ‡∏ß) ====== */
const user_id = localStorage.getItem("user_id") || "U001";

/* ================= LOAD ORDERS ================= */
fetch(`${API_BASE}?action=getOrders&api_key=${API_KEY}&user_id=${user_id}`)
.then(r=>r.json())
.then(res=>{
  const box=document.getElementById("ordersBox");
  box.innerHTML="";
  if(!res.success || res.orders.length===0){
    box.innerHTML='<div class="empty">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</div>';
    return;
  }
  res.orders.forEach(o=>{
    const div=document.createElement("div");
    div.className="order-card";
    div.innerHTML=`
      <div class="order-top">
        <div class="order-id">${o.order_id}</div>
        <div class="badge ${o.status}">${o.status}</div>
      </div>
      <div class="row">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£: ${o.service_id}</div>
      <div class="row">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${o.qty}</div>
      <div class="row link">‡∏•‡∏¥‡∏á‡∏Å‡πå: ${o.link}</div>
      ${o.comment_text ? `<div class="row">‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ó‡πå: ${o.comment_text}</div>` : ``}
      <div class="price">‡∏ø ${o.final_total}</div>
      <div class="row">‡πÄ‡∏ß‡∏•‡∏≤: ${new Date(o.datetime).toLocaleString()}</div>
    `;
    box.appendChild(div);
  });
})
.catch(err=>{
  document.getElementById("ordersBox").innerHTML=
    '<div class="empty">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';
});
</script>

</body>
</html>