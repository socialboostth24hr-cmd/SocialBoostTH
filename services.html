<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>เลือกบริการ | SocialBoostTH</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:#0b0f14;
  color:#e5e7eb;
}
header{
  padding:16px;
  text-align:center;
  font-size:18px;
  font-weight:700;
  background:#111827;
}
.container{
  padding:16px;
  max-width:720px;
  margin:auto;
}
.service{
  background:#111827;
  border:1px solid #1f2937;
  border-radius:16px;
  padding:16px;
  margin-bottom:14px;
}
.name{
  font-size:16px;
  font-weight:700;
}
.desc{
  font-size:13px;
  color:#9ca3af;
  margin-top:6px;
}
.meta{
  display:flex;
  gap:12px;
  font-size:13px;
  margin-top:10px;
}
.badge{
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:700;
}
.badge.on{background:#16a34a;color:#fff}
.badge.hot{background:#dc2626;color:#fff}
.badge.new{background:#2563eb;color:#fff}

.footer{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:14px;
}
.price{
  font-size:18px;
  font-weight:700;
}
.btn{
  padding:10px 16px;
  border-radius:10px;
  border:none;
  font-weight:700;
  cursor:pointer;
  background:linear-gradient(135deg,#38bdf8,#8b5cf6,#ec4899);
  color:#fff;
}
.center{padding:40px;text-align:center;color:#9ca3af}
.error{color:#ef4444}
</style>
</head>

<body>

<header>เลือกบริการ</header>

<div class="container" id="list">
  <div class="center">กำลังโหลดบริการ…</div>
</div>

<script>
/* ================= CONFIG ================= */
const API_BASE = "https://script.google.com/macros/s/AKfycbxAK7GDFGG-W_cKJeZ6YVLG2CeJKRcnamrYCyeUW2M68kjjMjvRCh2jqUjYEtOWFGpmSw/exec";
const API_KEY  = "SBTH-SECURE-2026";

/* ================= LOAD ================= */
fetch(`${API_BASE}?action=getServices&api_key=${API_KEY}`)
  .then(r=>r.json())
  .then(res=>{
    if(!res.success || !res.services.length){
      document.getElementById("list").innerHTML =
        `<div class="center error">ไม่พบบริการ</div>`;
      return;
    }
    render(res.services);
  })
  .catch(()=>{
    document.getElementById("list").innerHTML =
      `<div class="center error">เชื่อมต่อระบบไม่ได้</div>`;
  });

/* ================= RENDER ================= */
function render(services){
  const box = document.getElementById("list");
  box.innerHTML = "";
  services.forEach(s=>{
    box.insertAdjacentHTML("beforeend",`
      <div class="service">
        <div class="name">${s.display_name}</div>
        <div class="desc">${s.short_desc || ""}</div>

        <div class="meta">
          <span>ขั้นต่ำ ${s.min_qty}</span>
          ${s.badge_status==="on"
            ? `<span class="badge ${s.badge_type||"on"}">${s.badge_text}</span>`
            : ``}
        </div>

        <div class="footer">
          <div class="price">${s.price_per_100} / 100</div>
          <button class="btn"
            onclick="selectService(
              '${s.service_id}',
              '${s.service_type}',
              '${s.display_name}'
            )">
            เลือกบริการ
          </button>
        </div>
      </div>
    `);
  });
}

/* ================= SELECT ================= */
function selectService(id,type,name){
  localStorage.setItem("service_id",id);
  localStorage.setItem("service_type",type); // INT / COMMENT
  localStorage.setItem("service_name",name);
  location.href="order.html";
}
</script>

</body>
</html>