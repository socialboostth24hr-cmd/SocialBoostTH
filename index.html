<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>SocialBoostTH</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  margin:0;font-family:system-ui;
  background:linear-gradient(180deg,#0b0216,#1a0438);
  color:#fff;
}
.container{
  max-width:420px;margin:40px auto;padding:24px;
  background:#120726;border-radius:18px;
}
label{font-size:14px;display:block;margin-top:12px}
input,button{
  width:100%;padding:14px;margin-top:6px;
  border-radius:12px;border:1px solid #2e1065;
  background:#0f0220;color:#fff;font-size:15px;
}
button{
  margin-top:18px;border:none;font-weight:bold;
  background:linear-gradient(90deg,#7c3aed,#5b21b6);
}
.box{
  background:#0f0220;border:1px solid #2e1065;
  padding:12px;border-radius:12px;margin-top:10px;
}
.msg{text-align:center;margin-top:10px}
</style>
</head>

<body>

<div class="container" id="loginBox">
  <h1 style="text-align:center">SocialBoostTH</h1>

  <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
  <input id="email">

  <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
  <input id="password" type="password">

  <button onclick="login()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
  <div id="loginMsg" class="msg"></div>
</div>

<div class="container" id="panel" style="display:none">
  <div class="box">
    üë§ <b id="username"></b><br>
    üí∞ ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: <b id="credit"></b>
  </div>
  <button onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
</div>

<script>
const SHEET_ID = "10hFozE-vcdtPhX7KiGs3JTndpvxbUNDHDzhpvPxIz-4";
const USERS_API = `https://opensheet.elk.sh/${SHEET_ID}/users`;

async function login(){
  loginMsg.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";

  const inputEmail = email.value.trim().toLowerCase();
  const inputPass  = password.value.trim();

  try{
    const res = await fetch(USERS_API);
    const raw = await res.json();

    // üîé normalize ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ó
    const users = raw.map(u => ({
      user_id: String(u.user_id || "").trim(),
      fullname: String(u.fullname || "").trim(),
      email: String(u.email || "").trim().toLowerCase(),
      password: String(u.password || "").trim(),
      credit: Number(String(u.credit || "0").trim())
    }));

    const user = users.find(u =>
      u.email === inputEmail && u.password === inputPass
    );

    if(!user){
      loginMsg.innerText = "‚ùå ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
      console.log("DEBUG USERS:", users);
      return;
    }

    localStorage.setItem("user", JSON.stringify(user));
    showPanel(user);

  }catch(e){
    loginMsg.innerText = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ";
    console.error(e);
  }
}

function showPanel(user){
  loginBox.style.display = "none";
  panel.style.display = "block";
  username.innerText = user.fullname;
  credit.innerText = user.credit;
}

function logout(){
  localStorage.removeItem("user");
  location.reload();
}
</script>

</body>
</html>