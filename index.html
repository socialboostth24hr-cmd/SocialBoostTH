<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>SocialBoostTH</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>
body{
  margin:0;
  font-family:system-ui;
  background:#0f172a;
  color:#fff
}
.container{
  max-width:420px;
  margin:40px auto;
  padding:24px;
  background:#020617;
  border-radius:16px
}
input,button{
  width:100%;
  padding:14px;
  margin-top:10px;
  border-radius:10px;
  border:none
}
input{
  background:#020617;
  color:#fff;
  border:1px solid #1e293b
}
button{
  background:#22c55e;
  font-weight:bold
}
.box{
  background:#020617;
  padding:12px;
  border-radius:10px;
  margin-top:12px
}
.small{
  font-size:13px;
  opacity:.85
}
</style>
</head>

<body>
<div class="container">

<h2>à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š</h2>

<!-- LOGIN -->
<div id="loginBox">
  <input id="email" placeholder="à¸­à¸µà¹€à¸¡à¸¥">
  <input id="password" type="password" placeholder="à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™">
  <button onclick="login()">à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š</button>
  <div id="msg" class="small"></div>
</div>

<!-- PANEL -->
<div id="panel" style="display:none">

  <div class="box">
    ðŸ‘¤ <b id="name"></b><br>
    ðŸ’° à¹€à¸„à¸£à¸”à¸´à¸•à¸„à¸‡à¹€à¸«à¸¥à¸·à¸­: <b id="credit"></b>
  </div>

  <input id="service" placeholder="à¸šà¸£à¸´à¸à¸²à¸£">
  <input id="qty" type="number" placeholder="à¸ˆà¸³à¸™à¸§à¸™">
  <input id="link" placeholder="à¸¥à¸´à¸‡à¸à¹Œ TikTok">
  <button onclick="order()">à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­</button>

  <div id="orders" class="small"></div>
</div>

</div>

<script>
/* ===== CONFIG ===== */
const API = "https://hook.us2.make.com/i91b675rawoy52l11v5msfwjerf7uv31";
let user = null;

/* ===== LOGIN ===== */
function login(){
  msg.innerText = "à¸à¸³à¸¥à¸±à¸‡à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­...";

  fetch(API,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      type:"login",          // âœ… à¸•à¸£à¸‡à¸à¸±à¸š Make
      email: email.value,
      password: password.value
    })
  })
.then(async res => {
  const t = await res.text();
  console.log("RAW RESPONSE:", t);
  return JSON.parse(t);
})
  .then(d => {

    if(d.status !== "success"){
      msg.innerText = d.message || "à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸šà¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ";
      return;
    }

    // à¹€à¸à¹‡à¸š user
    user = d;

    name.innerText = d.fullname;
    credit.innerText = d.credit;

    loginBox.style.display = "none";
    panel.style.display = "block";
    msg.innerText = "";
  })
  .catch(err=>{
    console.error(err);
    msg.innerText = "à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸£à¸°à¸šà¸šà¹„à¸¡à¹ˆà¹„à¸”à¹‰";
  });
}

/* ===== ORDER (à¹„à¸§à¹‰à¸•à¹ˆà¸­ Make à¸ à¸²à¸¢à¸«à¸¥à¸±à¸‡) ===== */
function order(){
  if(!user) return alert("à¸à¸£à¸¸à¸“à¸²à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸šà¸à¹ˆà¸­à¸™");

  fetch(API,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      type:"order",
      user_id: user.user_id,
      service: service.value,
      qty: qty.value,
      link: link.value
    })
  })
  .then(r=>r.json())
  .then(d=>{
    if(d.status !== "success"){
      alert(d.message || "à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ");
      return;
    }

    orders.innerHTML += "ðŸ“¦ "+d.order_id+"<br>";
    credit.innerText = d.credit;
  });
}
</script>
</body>
</html>