<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>เช็คสถานะคำสั่งซื้อ | SocialBoostTH</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:linear-gradient(180deg,#060b1e,#020617);
  color:#ffffff;
}
.container{
  max-width:420px;
  margin:auto;
  padding:24px;
}
.card{
  background:rgba(255,255,255,0.06);
  border-radius:20px;
  padding:24px;
  box-shadow:0 0 40px rgba(0,0,0,.5);
}
h1{
  text-align:center;
  margin:0 0 6px;
}
.sub{
  text-align:center;
  opacity:.75;
  margin-bottom:22px;
  font-size:14px;
}
.row{
  margin-bottom:12px;
  font-size:15px;
  line-height:1.6;
}
.status{
  font-weight:700;
}
.pending{color:#facc15;}
.processing{color:#60a5fa;}
.completed{color:#22c55e;}
.error{
  text-align:center;
  color:#f87171;
  font-size:15px;
  margin-top:16px;
}
.note{
  margin-top:18px;
  font-size:13px;
  opacity:.7;
  line-height:1.6;
}
a{color:#93c5fd;word-break:break-all;}
</style>
</head>

<body>

<div class="container">
<div class="card">

<h1>สถานะคำสั่งซื้อ</h1>
<div class="sub">SocialBoostTH</div>

<div id="content" style="display:none">
  <div class="row"><b>เลขออเดอร์:</b> <span id="o_id"></span></div>
  <div class="row"><b>บริการ:</b> <span id="o_service"></span></div>
  <div class="row"><b>จำนวน:</b> <span id="o_qty"></span></div>
  <div class="row"><b>ลิงก์:</b> <a id="o_link" target="_blank"></a></div>
  <div class="row"><b>สถานะ:</b> <span id="o_status" class="status"></span></div>
  <div class="row"><b>วันที่สั่ง:</b> <span id="o_date"></span></div>
</div>

<div id="error" class="error" style="display:none"></div>

<div class="note">
กรุณาเก็บลิงก์นี้ไว้เพื่อติดตามสถานะคำสั่งซื้อ  
ระบบจะอัปเดตข้อมูลอัตโนมัติเมื่อมีความคืบหน้า
</div>

</div>
</div>

<script>
var API_URL = "https://script.google.com/macros/s/AKfycbyEiHTGYqMyLRLuB3Wq1QleAUpm2KD_Kg-cyHcaEUvcfNdKz5gtbeWMgb2ZCGTG6mWP/exec";

var params = new URLSearchParams(window.location.search);
var token = params.get("token");

function showError(msg){
  var el=document.getElementById("error");
  el.innerText=msg;
  el.style.display="block";
}

if(!token){
  showError("❌ ลิงก์ไม่ถูกต้อง");
}else{
  fetch(API_URL + "?token=" + encodeURIComponent(token))
    .then(res=>res.json())
    .then(res=>{
      if(res.status!=="ok"){
        showError("❌ ไม่พบข้อมูลคำสั่งซื้อนี้");
        return;
      }
      var d=res.data;
      document.getElementById("o_id").innerText=d.order_id;
      document.getElementById("o_service").innerText=d.service;
      document.getElementById("o_qty").innerText=d.qty;
      document.getElementById("o_link").innerText=d.link;
      document.getElementById("o_link").href=d.link;
      document.getElementById("o_date").innerText=d.created_at;

      var st=document.getElementById("o_status");
      st.innerText=d.status;

      if(d.status==="รอดำเนินการ") st.classList.add("pending");
      if(d.status==="กำลังดำเนินการ") st.classList.add("processing");
      if(d.status==="เสร็จสิ้น") st.classList.add("completed");

      document.getElementById("content").style.display="block";
    })
    .catch(()=>{
      showError("❌ ไม่สามารถเชื่อมต่อระบบได้");
    });
}
</script>

</body>
</html>
